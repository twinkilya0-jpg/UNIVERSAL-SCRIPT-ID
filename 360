local RunService = game:GetService("RunService")
local lp = game:GetService("Players").LocalPlayer
local rotationConnection = nil
local rotationSpeed = 100000

local function startRotation()
    if rotationConnection then rotationConnection:Disconnect() end
    rotationConnection = RunService.Heartbeat:Connect(function(dt)
        local char = lp.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if hrp and getgenv().rotationEnabled then
            hrp.CFrame = hrp.CFrame * CFrame.Angles(0, math.rad(rotationSpeed * dt), 0)
        else
            if rotationConnection then 
                rotationConnection:Disconnect() 
                rotationConnection = nil 
            end
        end
    end)
end

task.spawn(function()
    while task.wait(1) do
        if getgenv().rotationEnabled and not rotationConnection then
            startRotation()
        elseif not getgenv().rotationEnabled and rotationConnection then
            rotationConnection:Disconnect()
            rotationConnection = nil
        end
    end
end)
